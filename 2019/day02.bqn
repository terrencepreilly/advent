
âŸ¨TestSuiteâŸ© â† â€¢Import "./Test.bqn"


parse â‡ {
  Clean â† ((','âŠ¸= âŠ‘)â—¶âŠ¢â€¿(1âŠ¸â†“))Â¨
  IParse â† +`âˆ˜(','âŠ¸=) âŠ” âŠ¢
  â€¢ParseFloatÂ¨ âˆ˜ Clean âˆ˜ IParse
}

_op â† { pos f _ğ•£ code :
  src1â€¿src2â€¿dest â† 3 â†‘ (pos + 1) â†“ code

  res â† FÂ´ src1â€¿src2 âŠ code
  resâŒ¾(destâŠ¸âŠ‘) code
}

Add â‡ + _op
Mult â‡ Ã— _op
Step â‡ +âŸœ4

Run â‡ {
  pos ğ•Š code : 99 = pos âŠ‘ code ?
    code;
  pos ğ•Š code : 1 = pos âŠ‘ code ?
     (4 + pos) ğ•Š pos Add code;
  pos ğ•Š code : 2 = pos âŠ‘ code ?
    (4 + pos) ğ•Š pos Mult code;
  Â¯1
}

ParseAndRun â‡ 0âŠ¸Run âˆ˜ Parse

ResetState â‡ { nounâ€¿verb ğ•Š code :  nounâŒ¾(1âŠ¸âŠ‘) âˆ˜ (verbâŒ¾(2âŠ¸âŠ‘)) code }

data â‡ 12â€¿2 ResetState Parse Â¯1 â†“ â€¢FChars "input02.txt"

# solution â‡ 0 Run data
# â€¢Out â€¢Repr âŠ‘ solution


_applyRanges â† {
  (0 = â‰  ğ•¨) âˆ§ (0 = â‰  ğ•©) ?
    ğ•¨ ğ”½ ğ•© ;
  (0 = â‰  ğ•¨) ?
    (ğ•¨ ğ”½ âŠ‘ ğ•©) âˆ¾ ğ•¨ (ğ•£ ğ”½) (1 â†“ ğ•©) ;
  (ğ•© (ğ•£ ğ”½)Ëœ âŠ‘ ğ•¨) âˆ¾ ğ•© (ğ•£ ğ”½)Ëœ (1 â†“ ğ•©)
}

ts â† TestSuite "Day02"

{ ğ•¤ â‹„
  data â† "1,9,10,3,2,3,11,0,99,30,40,50"
  1â€¿9â€¿10â€¿3â€¿2â€¿3â€¿11â€¿0â€¿99â€¿30â€¿40â€¿50 â‰¡ Parse data
} ts._Test "1.e1 Parse"

{ ğ•¤ â‹„
  âŸ¨1âŸ© = Parse "1"
} ts._Test "1.e2 Simplest Parse"

{
  10â€¿4â€¿5â€¿0â€¿4â€¿6 â‰¡ 0 Add 1â€¿4â€¿5â€¿0â€¿4â€¿6
} ts._Test "1.e3 Add"

{
  24â€¿4â€¿5â€¿0â€¿4â€¿6 â‰¡ 0 Mult 2â€¿4â€¿5â€¿0â€¿4â€¿6
} ts._Test "1.e4 Mult"

{ 3500 = âŠ‘ ParseAndRun "1,9,10,3,2,3,11,0,99,30,40,50" } ts._Test "1.1"
{ 2 = âŠ‘ ParseAndRun "1,0,0,0,99" } ts._Test "1.2"
{ 6 = 3 âŠ‘ ParseAndRun "2,3,0,3,99" } ts._Test "1.3"
{ 9801 = Â¯1 âŠ‘ ParseAndRun "2,4,4,5,99,0" } ts._Test "1.4"
{ 30 = âŠ‘ ParseAndRun "1,1,1,4,99,5,6,0,99" } ts._Test "1.5"

{ 4 = âŠ‘ ParseAndRun "1,4,4,0,1,4,0,0,2,4,0,0,2,4,0,0,2,4,0,0,1,4,0,0,99" } ts._Test "1.e5"


{
    F â† +
    4â€¿5â€¿5â€¿6 â‰¡ 1â€¿2 _applyRanges F 3â€¿4
} ts._Test "2.e1 Applying args"

ts.Report @
